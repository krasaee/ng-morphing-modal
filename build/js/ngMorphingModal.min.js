var ngMorphingModal=angular.module("ngMorphingModal",[]).directive("ngMorphingModal",function(){return{replace:!0,restrict:"AE",scope:{contentSelector:"@",selectorId:"@?",buttonOpenId:"@",buttonCloseId:"@",afterOpenFn:"&?",afterCloseFn:"&?"},link:function(n,e,t){var i=function(i){if(i.target.hasAttribute("close-id")){var o=e.find('[close-id="'+n.buttonCloseId+'"]');return n.closeModal(o),void(angular.isDefined(t.afterCloseFn)&&n.afterCloseFn(o))}if(i.target.hasAttribute("open-id")){var o=e.find('[open-id="'+n.buttonOpenId+'"]');return n.openModal(o),void(angular.isDefined(t.afterOpenFn)&&n.afterOpenFn(o))}console.log("Invalid callback, no open-id and or close-id defined for this morph modal",e,n)};e.bind("click",i)},templateUrl:function(n,e){return null!=e.templateUrl?e.templateUrl:"ng-morphing-modal.html"},controller:function(n){n.openModal=function(e){var t=n.retrieveScale(e.next(".cd-modal-bg"));e.addClass("to-circle"),e.next(".cd-modal-bg").addClass("is-visible").one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(){n.animateLayer(e.next(".cd-modal-bg"),t,!0)}),e.parents(".no-csstransitions").length>0&&n.animateLayer(e.next(".cd-modal-bg"),t,!0)},n.closeModal=function(){var e=$(".cd-section.modal-is-visible");e.removeClass("modal-is-visible").one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(){n.animateLayer(e.find(".cd-modal-bg"),1,!1)}),e.parents(".no-csstransitions").length>0&&n.animateLayer(e.find(".cd-modal-bg"),1,!1)},n.retrieveScale=function(n){var e=this;if(n.offset()){var t=n.width()/2,i=n.offset().left+t,o=n.offset().top+t-$(window).scrollTop(),a=e.scaleValue(o,i,t,$(window).height(),$(window).width());n.css("position","fixed").velocity({top:o-t,left:i-t,translateX:0},0)}else a=1;return a},n.scaleValue=function(n,e,t,i,o){var a=e>i/2?e:i-e,s=n>o/2?n:o-n;return Math.ceil(Math.sqrt(Math.pow(a,2)+Math.pow(s,2))/t)},n.animateLayer=function(e,t,i){e.velocity({scale:t},400,function(){$("body").toggleClass("overflow-hidden",i),i?e.parents(".cd-section").addClass("modal-is-visible").end().off("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend"):e.removeClass("is-visible").removeAttr("style").siblings(n.selectorId).removeClass("to-circle")})},n.updateLayer=function(){var n=this,e=$(".cd-section.modal-is-visible").find(".cd-modal-bg"),t=e.width()/2,i=e.siblings(".btn").offset().top+t-$(window).scrollTop(),o=e.siblings(".btn").offset().left+t,a=n.scaleValue(i,o,t,$(window).height(),$(window).width());e.velocity({top:i-t,left:o-t,scale:a},0)}}}});